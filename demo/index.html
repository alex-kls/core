<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
    <script src="build/fin-hypergrid.js"></script>
    <script>
        'use strict';

        var HTTP_STATE_DONE = 4,
            HTTP_STATUS_OK = 200;

        function get(url, callback) {
            var httpRequest = new XMLHttpRequest();
            httpRequest.open('GET', url, true);
            httpRequest.onreadystatechange = function() {
                if (
                    httpRequest.readyState === HTTP_STATE_DONE &&
                    httpRequest.status === HTTP_STATUS_OK
                ) {
                    callback(JSON.parse(httpRequest.responseText));
                }
            };
            httpRequest.send(null);
        }

        window.onload = function() {
            get('data/test_data.json', function(data) {
                var loadingSpan = document.querySelector('span#loading');
                loadingSpan.style.visibility = "hidden";
                var div = document.querySelector('div#json-example');
                var inLoad = false;

                function loadData(data) {
                    inLoad = false;
                    window.grid.addData(data);
                }

                function onScrollEnd() {
                    console.log("SCROLL END");
                    if (!inLoad) {
                        inLoad = true;
                        get('data/test_data.json', loadData);
                    }
                }

                var options = {
                    data: data,
                    callbacks: {
                        onScrollEndLimitTrigger: 200,
                        onScrollEnd: onScrollEnd,
                    }
                };
                window.grid = new fin.Hypergrid(div, options);

                var themeObject = {
                    noDataMessage: 'Zero Rows!',
                    backgroundColor: 'white',
                    foregroundSelectionFont: '12px "Helvetica Neue",Helvetica,Arial,sans-serif',
                    backgroundSelectionColor: 'rgb(236,243,255)',
                    foregroundSelectionColor: '#333',
                    columnClip: false,
                    defaultRowHeight: 21,
                    editor: 'textfield',
                    rowHeaderColor: '#333',
                    lineColor: '#DEDEDE',
                    renderFalsy: true,
                    rowHeaderCheckboxes: false,
                    rowHeaderForegroundSelectionFont: '12px "Helvetica Neue",Helvetica,Arial,sans-serif',
                    font: '12px "Helvetica Neue",Helvetica,Arial,sans-serif',
                    selectionRegionOutlineColor: 'rgb(143,177,232)',
                    gridBorder:true,
                    hoverColumnHighlight: false,
                    hoverRowHighlight: false,
                    halign: 'left'
                };

                grid.applyTheme(themeObject);
            });
        };
    </script>
    <style>
        div.finbar-horizontal>.thumb,
        div.finbar-vertical>.thumb {
            background-color: #000 !important;
            opacity: 0.7 !important;
        }
    </style>
</head>
<body>

<p> Fin-HyperGrid example using AJAX. <span id="loading">Loading... </span></p>
<div id="json-example" style="position:relative; width:100%; height: 100%"></div>
</body>
</html>
